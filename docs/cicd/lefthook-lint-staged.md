# lefthook + lint-staged ì„¤ì • ê°€ì´ë“œ

## ğŸ“š ëª©ì°¨

1. [Git Hooksë€?](#git-hooksë€)
2. [lefthookì´ë€?](#lefthookì´ë€)
3. [lint-stagedë€?](#lint-stagedë€)
4. [ì™œ ì´ ì¡°í•©ì„ ì‚¬ìš©í•˜ëŠ”ê°€?](#ì™œ-ì´-ì¡°í•©ì„-ì‚¬ìš©í•˜ëŠ”ê°€)
5. [ì„¤ì • ë°©ë²•](#ì„¤ì •-ë°©ë²•)
6. [ë™ì‘ ì›ë¦¬](#ë™ì‘-ì›ë¦¬)
7. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
8. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

---

## Git Hooksë€?

**Git Hooks**ëŠ” Gitì´ íŠ¹ì • ì´ë²¤íŠ¸(ì»¤ë°‹, í‘¸ì‹œ ë“±)ë¥¼ ìˆ˜í–‰í•˜ê¸° ì „í›„ì— ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

### ì£¼ìš” Git Hooks

- **pre-commit**: ì»¤ë°‹í•˜ê¸° **ì „**ì— ì‹¤í–‰
- **pre-push**: í‘¸ì‹œí•˜ê¸° **ì „**ì— ì‹¤í–‰
- **post-commit**: ì»¤ë°‹í•œ **í›„**ì— ì‹¤í–‰
- **post-merge**: ë¨¸ì§€í•œ **í›„**ì— ì‹¤í–‰

### ì™œ í•„ìš”í•œê°€?

ì»¤ë°‹ì´ë‚˜ í‘¸ì‹œ ì „ì— ìë™ìœ¼ë¡œ ì½”ë“œ í’ˆì§ˆì„ ê²€ì‚¬í•˜ë©´:
- âœ… íƒ€ì… ì—ëŸ¬ê°€ ìˆëŠ” ì½”ë“œê°€ ì»¤ë°‹ë˜ëŠ” ê²ƒì„ ë°©ì§€
- âœ… ë¦°íŠ¸ ì—ëŸ¬ê°€ ìˆëŠ” ì½”ë“œê°€ ë¦¬í¬ì§€í† ë¦¬ì— ì˜¬ë¼ê°€ëŠ” ê²ƒì„ ë°©ì§€
- âœ… í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•œ ì½”ë“œë¥¼ ë°°í¬í•˜ëŠ” ê²ƒì„ ë°©ì§€
- âœ… íŒ€ ì „ì²´ì˜ ì½”ë“œ í’ˆì§ˆì„ ì¼ê´€ë˜ê²Œ ìœ ì§€

---

## lefthookì´ë€?

**lefthook**ì€ Git Hooksë¥¼ ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### Husky vs lefthook

| íŠ¹ì§• | Husky | lefthook |
|------|-------|----------|
| **ì†ë„** | ìˆœì°¨ ì‹¤í–‰ | ë³‘ë ¬ ì‹¤í–‰ (ë¹ ë¦„) |
| **ì„¤ì •** | ë³µì¡ (ì—¬ëŸ¬ íŒŒì¼) | ê°„ë‹¨ (YAML í•˜ë‚˜) |
| **TypeScript** | ì œí•œì  | ì™„ë²½ ì§€ì› |
| **ì—ëŸ¬ ë©”ì‹œì§€** | ê¸°ë³¸ì  | ìƒì„¸í•¨ |

### lefthookì˜ ì¥ì 

1. **ë¹ ë¥¸ ì‹¤í–‰**: ì—¬ëŸ¬ ëª…ë ¹ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ì—¬ ì†ë„ í–¥ìƒ
2. **ê°„ë‹¨í•œ ì„¤ì •**: `.lefthook.yml` íŒŒì¼ í•˜ë‚˜ë¡œ ëª¨ë“  ì„¤ì • ê´€ë¦¬
3. **TypeScript ì§€ì›**: TypeScript í”„ë¡œì íŠ¸ì— ìµœì í™”
4. **ì¢‹ì€ ì—ëŸ¬ ë©”ì‹œì§€**: ë¬¸ì œ ë°œìƒ ì‹œ ëª…í™•í•œ ì•ˆë‚´

---

## lint-stagedë€?

**lint-staged**ëŠ” Gitì— **stagedëœ íŒŒì¼ë§Œ** ì„ íƒì ìœ¼ë¡œ ë¦°íŠ¸/í¬ë§·íŒ…ì„ ì‹¤í–‰í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### ì™œ í•„ìš”í•œê°€?

ì „ì²´ íŒŒì¼ì„ ê²€ì‚¬í•˜ë©´:
- âŒ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼ (ìˆ˜ë°± ê°œì˜ íŒŒì¼)
- âŒ ë³€ê²½í•˜ì§€ ì•Šì€ íŒŒì¼ê¹Œì§€ ê²€ì‚¬ (ë¶ˆí•„ìš”)
- âŒ ì»¤ë°‹ì´ ëŠë ¤ì§

stagedëœ íŒŒì¼ë§Œ ê²€ì‚¬í•˜ë©´:
- âœ… ë¹ ë¥¸ ì‹¤í–‰ (ë³€ê²½ëœ íŒŒì¼ë§Œ)
- âœ… íš¨ìœ¨ì ì¸ ê²€ì‚¬
- âœ… ë¹ ë¥¸ ì»¤ë°‹

### ë™ì‘ ë°©ì‹

```bash
# ì˜ˆì‹œ: 3ê°œ íŒŒì¼ì„ ìˆ˜ì •í•˜ê³  2ê°œë§Œ staged
git add src/components/Button.tsx
git add src/components/Input.tsx
# src/utils/helper.tsëŠ” staged ì•ˆ í•¨

# lint-staged ì‹¤í–‰ ì‹œ
# â†’ Button.tsxë§Œ ê²€ì‚¬ âœ…
# â†’ Input.tsxë§Œ ê²€ì‚¬ âœ…
# â†’ helper.tsëŠ” ê²€ì‚¬ ì•ˆ í•¨ (staged ì•ˆ ë¨)
```

---

## ì™œ ì´ ì¡°í•©ì„ ì‚¬ìš©í•˜ëŠ”ê°€?

### lefthook + lint-staged ì¡°í•©

```
ì»¤ë°‹ ì‹œë„
    â†“
lefthook (pre-commit í›… ì‹¤í–‰)
    â†“
lint-staged (staged íŒŒì¼ë§Œ ê²€ì‚¬)
    â†“
ESLint ì‹¤í–‰ (ìë™ ìˆ˜ì •)
    â†“
ê²€ì‚¬ í†µê³¼ â†’ ì»¤ë°‹ ì„±ê³µ âœ…
ê²€ì‚¬ ì‹¤íŒ¨ â†’ ì»¤ë°‹ ì°¨ë‹¨ âŒ
```

### ì¥ì 

1. **ë¹ ë¥¸ í”¼ë“œë°±**: ì»¤ë°‹ ì „ì— ì¦‰ì‹œ ë¬¸ì œ ë°œê²¬
2. **ìë™ ìˆ˜ì •**: ESLintê°€ ìë™ìœ¼ë¡œ ìˆ˜ì • ê°€ëŠ¥í•œ ë¬¸ì œ í•´ê²°
3. **íš¨ìœ¨ì **: ë³€ê²½ëœ íŒŒì¼ë§Œ ê²€ì‚¬
4. **ì¼ê´€ì„±**: ëª¨ë“  íŒ€ì›ì´ ë™ì¼í•œ ì½”ë“œ í’ˆì§ˆ ê¸°ì¤€ ì ìš©

---

## ì„¤ì • ë°©ë²•

### 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
npm install -D lefthook lint-staged
```

### 2. lefthook ì´ˆê¸°í™”

```bash
npx lefthook install
```

ì´ ëª…ë ¹ì€ `.git/hooks` í´ë”ì— Git hooksë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

### 3. `.lefthook.yml` íŒŒì¼ ìƒì„±

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.lefthook.yml` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤:

```yaml
# lefthook ì„¤ì • íŒŒì¼
# Git hooksë¥¼ ê´€ë¦¬í•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.

pre-commit:
  parallel: true
  commands:
    lint-staged:
      run: npx lint-staged
      stage_fixed: true
```

**ì„¤ëª…:**
- `pre-commit`: ì»¤ë°‹ ì „ì— ì‹¤í–‰ë˜ëŠ” í›…
- `parallel: true`: ì—¬ëŸ¬ ëª…ë ¹ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰ (ë¹ ë¦„)
- `run: npx lint-staged`: lint-staged ì‹¤í–‰
- `stage_fixed: true`: ìë™ ìˆ˜ì •ëœ íŒŒì¼ì„ ë‹¤ì‹œ stagedì— ì¶”ê°€

### 4. `package.json`ì— lint-staged ì„¤ì • ì¶”ê°€

```json
{
  "scripts": {
    "prepare": "lefthook install"
  },
  "lint-staged": {
    "*.{ts,tsx,js,jsx}": [
      "eslint --fix"
    ]
  }
}
```

**ì„¤ëª…:**
- `prepare` ìŠ¤í¬ë¦½íŠ¸: `npm install` ì‹œ ìë™ìœ¼ë¡œ lefthook ì„¤ì¹˜
- `lint-staged`: íŒŒì¼ íŒ¨í„´ë³„ë¡œ ì‹¤í–‰í•  ëª…ë ¹ ì •ì˜
  - `*.{ts,tsx,js,jsx}`: TypeScript/JavaScript íŒŒì¼
  - `eslint --fix`: ESLint ì‹¤í–‰ ë° ìë™ ìˆ˜ì •

---

## ë™ì‘ ì›ë¦¬

### ì „ì²´ í”Œë¡œìš°

```
1. ê°œë°œìê°€ ì½”ë“œ ìˆ˜ì •
   â†“
2. git add (íŒŒì¼ì„ staged ìƒíƒœë¡œ)
   â†“
3. git commit ì‹œë„
   â†“
4. lefthookì´ pre-commit í›… ê°ì§€
   â†“
5. lint-staged ì‹¤í–‰
   â†“
6. stagedëœ íŒŒì¼ë§Œ ESLint ê²€ì‚¬
   â†“
7-1. ë¬¸ì œ ì—†ìŒ â†’ ì»¤ë°‹ ì„±ê³µ âœ…
7-2. ë¬¸ì œ ìˆìŒ â†’ ì»¤ë°‹ ì°¨ë‹¨, ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ âŒ
```

### ì‹¤ì œ ì˜ˆì‹œ

```bash
# 1. íŒŒì¼ ìˆ˜ì •
vim src/components/Button.tsx

# 2. stagedì— ì¶”ê°€
git add src/components/Button.tsx

# 3. ì»¤ë°‹ ì‹œë„
git commit -m "feat: ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€"

# 4. lefthookì´ ìë™ ì‹¤í–‰
# â†’ lint-staged ì‹¤í–‰
# â†’ Button.tsxì— ESLint ì‹¤í–‰
# â†’ ë¬¸ì œ ë°œê²¬: ì„¸ë¯¸ì½œë¡  ëˆ„ë½

# 5. ê²°ê³¼
# âŒ ì»¤ë°‹ ì‹¤íŒ¨
# ì—ëŸ¬: ESLint found problems in Button.tsx
# í•´ê²°: ESLint --fixë¡œ ìë™ ìˆ˜ì • í›„ ë‹¤ì‹œ ì»¤ë°‹
```

---

## ì‚¬ìš© ë°©ë²•

### ì •ìƒì ì¸ ì‚¬ìš©

```bash
# 1. íŒŒì¼ ìˆ˜ì •
# 2. stagedì— ì¶”ê°€
git add .

# 3. ì»¤ë°‹
git commit -m "feat: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€"

# lefthookì´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë¨
# ë¬¸ì œ ì—†ìœ¼ë©´ ì»¤ë°‹ ì„±ê³µ âœ…
```

### ë¬¸ì œê°€ ìˆì„ ë•Œ

```bash
git commit -m "feat: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€"

# âŒ ì»¤ë°‹ ì‹¤íŒ¨
# ì—ëŸ¬ ë©”ì‹œì§€:
# ESLint found problems:
#   src/components/Button.tsx
#     5:1  error  Missing semicolon  semi

# í•´ê²° ë°©ë²•:
# 1. ESLintê°€ ìë™ ìˆ˜ì • ê°€ëŠ¥í•œ ê²½ìš°: ìë™ ìˆ˜ì •ë¨
# 2. ìˆ˜ë™ ìˆ˜ì • í•„ìš”: ì—ëŸ¬ ë©”ì‹œì§€ ë³´ê³  ìˆ˜ì •
# 3. ë‹¤ì‹œ ì»¤ë°‹ ì‹œë„
```

### lefthook ê±´ë„ˆë›°ê¸° (ë¹„ì¶”ì²œ)

```bash
# --no-verify í”Œë˜ê·¸ ì‚¬ìš© (ë¹„ì¶”ì²œ!)
git commit --no-verify -m "feat: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€"

# âš ï¸ ì£¼ì˜: ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ë¥¼ ê±´ë„ˆë›°ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤
```

---

## ë¬¸ì œ í•´ê²°

### lefthookì´ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```bash
# lefthook ì¬ì„¤ì¹˜
npx lefthook install

# ë˜ëŠ”
npm run prepare
```

### lint-stagedê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```bash
# package.jsonì˜ lint-staged ì„¤ì • í™•ì¸
# .lefthook.ymlì˜ run ëª…ë ¹ í™•ì¸

# ìˆ˜ë™ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
npx lint-staged
```

### ESLint ì—ëŸ¬ê°€ ê³„ì† ë°œìƒí•  ë•Œ

```bash
# ESLint ì„¤ì • í™•ì¸
cat eslint.config.mjs

# ìˆ˜ë™ìœ¼ë¡œ ESLint ì‹¤í–‰
npx eslint src/components/Button.tsx --fix
```

### prepare ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```bash
# package.json í™•ì¸
# "prepare": "lefthook install" ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆëŠ”ì§€ í™•ì¸

# ìˆ˜ë™ ì‹¤í–‰
npm run prepare
```

---

## ìš”ì•½

### í•µì‹¬ ê°œë…

1. **Git Hooks**: Git ì´ë²¤íŠ¸ ì „í›„ì— ìë™ ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
2. **lefthook**: Git Hooksë¥¼ ì‰½ê²Œ ê´€ë¦¬í•˜ëŠ” ë„êµ¬ (Husky ëŒ€ì•ˆ)
3. **lint-staged**: stagedëœ íŒŒì¼ë§Œ ì„ íƒì ìœ¼ë¡œ ê²€ì‚¬í•˜ëŠ” ë„êµ¬

### ì„¤ì • ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] lefthook ì„¤ì¹˜ (`npm install -D lefthook`)
- [x] lint-staged ì„¤ì¹˜ (`npm install -D lint-staged`)
- [x] lefthook ì´ˆê¸°í™” (`npx lefthook install`)
- [x] `.lefthook.yml` íŒŒì¼ ìƒì„±
- [x] `package.json`ì— lint-staged ì„¤ì • ì¶”ê°€
- [x] `package.json`ì— prepare ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

### ë‹¤ìŒ ë‹¨ê³„

ì´ì œ ì»¤ë°‹í•  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì½”ë“œ í’ˆì§ˆì´ ê²€ì‚¬ë©ë‹ˆë‹¤!  
ë‹¤ìŒìœ¼ë¡œëŠ” [GitHub Actions CI íŒŒì´í”„ë¼ì¸](./github-actions.md)ì„ ì„¤ì •í•´ë³´ì„¸ìš”.

