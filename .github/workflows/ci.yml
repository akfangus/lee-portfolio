name: CI

# 이 워크플로우가 실행되는 조건
on:
  # main 브랜치에 push할 때
  push:
    branches: [main]
  # main 브랜치로 PR을 만들 때
  pull_request:
    branches: [main]

# 작업 정의
jobs:
  # 코드 품질 검증 작업
  quality:
    # 실행 환경 (Ubuntu 최신 버전)
    runs-on: ubuntu-latest

    # 작업 단계들
    steps:
      # 1. 코드 체크아웃 (GitHub 저장소에서 코드 가져오기)
      - name: Checkout code
        uses: actions/checkout@v4

      # 2. Node.js 설정
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          # Node.js 버전 (package.json의 engines와 일치)
          node-version: '20'
          # npm 캐시 사용 (빌드 속도 향상)
          cache: 'npm'

      # 3. 의존성 설치
      - name: Install dependencies
        run: npm ci
        # npm ci는 package-lock.json을 기반으로 정확히 동일한 버전 설치
        # npm install보다 빠르고 안정적

      # 4. TypeScript 타입 체크
      - name: Type Check
        run: npx tsc --noEmit
        # --noEmit: 타입 체크만 하고 파일 생성 안 함

      # 5. ESLint 린트 검사
      - name: Lint
        run: npm run lint
        # package.json의 lint 스크립트 실행

      # 6. Next.js 빌드
      - name: Build
        run: npm run build
        # 프로덕션 빌드가 성공하는지 확인
        # 빌드 실패 시 배포도 실패하므로 중요!



